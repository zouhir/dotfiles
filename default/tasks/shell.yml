- name: Change macOS shell back to homebrew zsh
  user:
    name: "{{ ansible_env.USER }}"
    shell: /opt/homebrew/bin/zsh
  when: ansible_os_family == "Darwin"
  become: yes 

- name: Download Starship installation script
  get_url:
    url: https://starship.rs/install.sh
    dest: /tmp/install_starship.sh
    mode: '0755'

- name: Clone zsh powerlevel10k
  git:
    repo: 'https://github.com/romkatv/powerlevel10k.git'
    dest: "{{ansible_env.HOME}}/.config/zsh/powerlevel10k"
    version: master
    depth: 1
  become_user: "{{ ansible_user_id }}"

- name: Clone zsh-autosuggestions
  git:
    repo: 'https://github.com/zsh-users/zsh-autosuggestions'
    dest: "{{ansible_env.HOME}}/.config/zsh/zsh-autosuggestions"
    version: master
  become_user: "{{ ansible_user_id }}"

- name: Clone zsh-syntax-highlighting
  git:
    repo: 'https://github.com/zsh-users/zsh-syntax-highlighting'
    dest: "{{ansible_env.HOME}}/.config/zsh/zsh-syntax-highlighting"
    version: master
  become_user: "{{ ansible_user_id }}"